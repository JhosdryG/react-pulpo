import e,{useState as t,useRef as n,useEffect as r}from"react";import o from"prop-types";import{FontAwesomeIcon as i}from"@fortawesome/react-fontawesome";import{faEdit as u,faTimesCircle as l}from"@fortawesome/free-solid-svg-icons";import c from"styled-components";var a=function(t){var n=t.data,r=t.properties,o=t.deleteRow,c=t.updateRow;return e.createElement("div",{className:"div-data-table"},e.createElement("table",{className:"data-table"},e.createElement("thead",null,e.createElement("tr",null,r.map((function(t){return"id"===t?null:e.createElement("th",{key:t},t)})),c&&e.createElement("td",null),o&&e.createElement("td",null))),e.createElement("tbody",null,n.map((function(t,n){return e.createElement("tr",{key:n},Object.keys(t).map((function(n,r){return"id"===n?null:e.createElement("td",{key:r},t[n])})),c&&e.createElement("td",{onClick:function(){return c(t.id)}},e.createElement(i,{icon:u,className:"update-icon"})),o&&e.createElement("td",{onClick:function(){return o(t.id)}},e.createElement(i,{icon:l,className:"delete-icon"})))})))))};function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var u,l=e[Symbol.iterator]();!(r=(u=l.next()).done)&&(n.push(u.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function m(){var e,t,n=(e=["\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  margin: ",";\n  width: ",";\n  font-family: ",";\n\n  & > [type='text'] {\n    padding: ",";\n    font-size: ",";\n    color: ",";\n    border: none;\n    border-top: ",";\n    border-left: ",";\n    border-bottom: ",";\n    border-right: ",";\n    outline: ",";\n    background-color: ",";\n    box-shadow: ",";\n    z-index: 2001;\n    ",";\n  }\n\n  & .filter {\n    position: relative;\n    box-sizing: border-box;\n\n    & > ul {\n      box-sizing: border-box;\n      position: absolute;\n      top: -20px;\n      left: 0;\n      width: ",";\n      list-style: none;\n      margin: 0;\n      padding: 0;\n      max-height: 200px;\n      border: ",";\n      border-top: none;\n      border-radius: ",";\n      box-shadow: ",";\n      overflow: auto;\n      z-index: 1000;\n      ",";\n\n      & > li {\n        cursor: pointer;\n        padding: ",";\n        background-color: ",";\n        color: ",";\n        ","\n\n        &:first-child {\n          padding-top: ","px;\n        }\n\n        &:last-child {\n          border-radius: ",";\n        }\n\n        &.current {\n          background-color: ",";\n          color: ",";\n          font-weight: ",";\n          font-size: ",";\n          ","\n        }\n      }\n\n      & > .no-match {\n        color: ",";\n        ","\n      }\n    }\n  }\n"],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return m=function(){return n},n}a.displayName="DataTable",a.propTypes={data:o.arrayOf(o.object).isRequired,properties:o.arrayOf(o.string).isRequired,deleteRow:o.func,updateRow:o.func};var y=c.div.attrs((function(e){var t=f({},e.style);return{style:f({},{divMargin:t.divMargin||"10px 10px 0 10px",divWidth:t.divWidth||"300px",divFont:t.divFont||"'Arial', Sans-Serif",divOthers:t.divOthers||"",inputPadding:t.inputPadding||"8px",inputFontSize:t.inputFontSize||"1rem",inputColor:t.inputColor||"rgb(60,60,60)",inputBorderTop:t.inputBorderTop||"none",inputBorderLeft:t.inputBorderLeft||"none",inputBorderBot:t.inputBorderBot||"3px solid #66d0dd",inputBorderRight:t.inputBorderRight||"none",inputOutline:t.inputOutline||"#66d0dd auto 3px",inputBackground:t.inputBackground||"fff",inputShadow:t.inputShadow||"0 0 5px rgba(0,0,0,.3)",inputOthers:t.inputOthers||"",listBorder:t.listBorder||"2px solid #66d0dd",listBorderRound:t.listBorderRound?"0 0 8px 8px":"0 0 0 0",listOthers:t.listOthers||"",itemPadding:t.itemPadding||"10px",itemBackground:t.itemBackground||"#fff",itemColor:t.itemColor||"rgb(60,60,60)",itemOthers:t.itemOthers||"",currentBackground:t.currentBackground||"#66d0dd",currentColor:t.currentColor||"#fff",currentFontWeight:t.currentFontWeight||"bold",currentFontSize:t.currentFontSize||"1.1rem",currentOthers:t.currentOthers||"",noMatchColor:t.noMatchColor||"rgb(180,180,180)",noMatchOthers:t.noMatchOthers||""})}}))(m(),(function(e){return e.style.divMargin}),(function(e){return e.style.divWidth}),(function(e){return e.style.divFont}),(function(e){return e.style.inputPadding}),(function(e){return e.style.inputFontSize}),(function(e){return e.style.inputColor}),(function(e){return e.style.inputBorderTop}),(function(e){return e.style.inputBorderLeft}),(function(e){return e.style.inputBorderBot}),(function(e){return e.style.inputBorderRight}),(function(e){return e.style.inputOutline}),(function(e){return e.style.inputBackground}),(function(e){return e.style.inputShadow}),(function(e){return e.style.inputOthers}),(function(e){return e.style.divWidth}),(function(e){return e.style.listBorder}),(function(e){return e.style.listBorderRound}),(function(e){return e.style.inputShadow}),(function(e){return e.style.listOthers}),(function(e){return e.style.itemPadding}),(function(e){return e.style.itemBackground}),(function(e){return e.style.itemColor}),(function(e){return e.style.itemOthers}),(function(e){return parseInt(e.style.itemPadding.replace("px",""))+20}),(function(e){return e.style.listBorderRound}),(function(e){return e.style.currentBackground}),(function(e){return e.style.currentColor}),(function(e){return e.style.currentFontWeight}),(function(e){return e.style.currentFontSize}),(function(e){return e.style.currentOthers}),(function(e){return e.style.noMatchColor}),(function(e){return e.style.noMatchOthers})),h=e.forwardRef((function(o,i){var u=o.data,l=o.filter,c=o.ListComponent,a=o.onSelect,d=o.onChange,s=o.showAtOnce,f=o.placeholder,m=o.noMatchMessage,h=o.style,b=o.setOptions,g=t(u)[0],v=p(t(0),2),O=v[0],x=v[1],w=p(t(""),2),k=w[0],B=w[1],C=p(t([]),2),E=C[0],j=C[1],R=p(t(!1),2),S=R[0],P=R[1],N=n(null);r((function(){b&&b({clean:function(){B(""),x(0),P(!1)}})}),[b]),r((function(){if(!S){if(1===k.length&&" "===k.charAt(0))return void B("");var e=[];if(""===k&&s||""!==k){for(var t,n=/\W/gi,r="^".concat(k.toLowerCase().trim()),o=[];null!==(t=n.exec(k));)o.includes(t[0])||(r=r.replace(RegExp("\\".concat(t[0]),"gi"),"\\".concat(t[0])),o.push(t[0]));e=g.filter((function(e){return new RegExp(r).test(e[l].toLowerCase().trim())}))}j(e),N.current&&N.current.scroll(0,0)}}),[k,g,s,l,S]);var M=function(e){x(e)},z=function(e){F(O)},F=function(e){E[e]&&(a(E[e]),B(E[e][l]),j([]),x(0),P(!0))};return e.createElement(y,{style:h},e.createElement("input",{type:"text",spellCheck:"false",placeholder:f,onKeyDown:function(e){38===e.keyCode?(e.preventDefault(),O>0&&(x((function(e){return e-1})),document.querySelector(".filter > ul > .current").scrollIntoView({block:"end",behavior:"smooth"}))):40===e.keyCode&&O<E.length-1&&(""!==k||s)&&!S?(x((function(e){return e+1})),document.querySelector(".filter > ul > .current").scrollIntoView({block:"start",behavior:"smooth"})):32===e.keyCode?(0===k.length||k.endsWith(" "))&&e.preventDefault():13===e.keyCode&&F(O)},onChange:function(e){B(e.target.value),x(0),P(!1),d&&d()},value:k,ref:i}),(k.length>0||s)&&!S&&e.createElement("div",{className:"filter"},e.createElement("ul",{ref:N},!S&&E.map((function(t,n){return e.createElement(c,{key:n,index:n,current:O===n,data:t,onMouseEnter:M,onClick:z})})),0===E.length&&k.length>0&&!S&&e.createElement("li",{className:"no-match"},m))))}));h.displayName="SelectFilter",h.defaultProps={showAtOnce:!1,placeholder:"",noMatchMessage:"No se han encontrado resultados"},h.propTypes={data:o.arrayOf(o.object).isRequired,filter:o.string.isRequired,ListComponent:o.any.isRequired,onSelect:o.func.isRequired,onChange:o.func,showAtOnce:o.bool,placeholder:o.string,noMatchMessage:o.string,style:o.object,setOptions:o.func};var b=e.forwardRef((function(r,o){var i=r.maxNumber,u=r.minNumber,l=r.handleAccept,c=r.labelText,a=r.buttonText,d=p(t(!1),2),s=d[0],f=d[1],m=p(t(""),2),y=m[0],h=m[1],b=n();return e.createElement("div",{className:"quantity-input"},e.createElement("label",{htmlFor:"quantity"},c,e.createElement("input",{type:"text",onKeyUp:function(e){13===e.keyCode&&s?b.current.focus():s||f(!0)},ref:o,onKeyDown:function(e){/\d/.test(e.key)?parseInt(e.target.value+e.key,10)<=i&&parseInt(e.target.value+e.key,10)>=u&&h(e.target.value+e.key):8===e.keyCode&&h((function(e){return e.substr(0,e.length-1)}))},value:y})),e.createElement("button",{type:"button",onClick:function(){return l(y)},ref:b,className:"quantity-input_button",disabled:""===y},a))}));b.displayName="QuantityInput",b.defaultProps={minNumber:1,maxNumber:100,labelText:"Cantidad",buttonText:"AÃ±adir"},b.propTypes={minNumber:o.number,maxNumber:o.number,handleAccept:o.func.isRequired,labelText:o.string,buttonText:o.string};export{a as DataTable,b as QuantityInput,h as SelectFilter};
