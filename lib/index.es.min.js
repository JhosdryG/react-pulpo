import e,{useState as n,useRef as t,useEffect as r}from"react";import o from"prop-types";import{FontAwesomeIcon as i}from"@fortawesome/react-fontawesome";import{faEdit as u,faTimesCircle as l}from"@fortawesome/free-solid-svg-icons";import c from"styled-components";function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function f(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],r=!0,o=!1,i=void 0;try{for(var u,l=e[Symbol.iterator]();!(r=(u=l.next()).done)&&(t.push(u.value),!n||t.length!==n);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var p=function(t){var r=t.data,o=t.properties,i=t.deleteRow,u=t.updateRow,l=t.onClickRow,c=f(n(null),2),a=c[0],d=c[1],s=function(e,n){l&&(l(e),d(n))};return e.createElement("div",{className:"div-data-table"},e.createElement("table",{className:"data-table"},e.createElement("thead",null,e.createElement("tr",null,o.map((function(n){return"id"===n?null:e.createElement("th",{key:n},n)})),u&&e.createElement("td",null),i&&e.createElement("td",null))),e.createElement("tbody",null,r.map((function(n,t){return e.createElement(m,{key:n.id,row:n,index:t,current:t===a,deleteRow:i||null,updateRow:u||null,onClickRow:l?s:null})})))))};p.displayName="DataTable",p.propTypes={data:o.arrayOf(o.object).isRequired,properties:o.arrayOf(o.string).isRequired,deleteRow:o.func,updateRow:o.func,onClickRow:o.func};var m=e.memo((function(n){var t=n.row,r=n.deleteRow,o=n.updateRow,c=n.onClickRow,a=n.index,d=n.current;return e.createElement("tr",{className:d?"current-row":null},Object.keys(t).map((function(n,r){return"id"===n?null:e.createElement("td",{key:r,onClick:c?function(){return c(t.id,a)}:null},t[n])})),o&&e.createElement("td",{onClick:function(){return o(t.id)}},e.createElement(i,{icon:u,className:"update-icon"})),r&&e.createElement("td",{onClick:function(){return r(t.id)}},e.createElement(i,{icon:l,className:"delete-icon"})))}),(function(e,n){var t=!0;return e.current===n.current&&(Object.keys(e.row).forEach((function(r){e.row[r]===n.row[r]||(t=!1)})),t)}));function y(){var e,n,t=(e=["\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  margin: ",";\n  width: ",";\n  font-family: ",";\n\n  & > [type='text'] {\n    box-sizing: border-box;\n    padding: ",";\n    font-size: ",";\n    color: ",";\n    width: 100%;\n    border: none;\n    border-top: ",";\n    border-left: ",";\n    border-bottom: ",";\n    border-right: ",";\n    outline: ",";\n    background-color: ",";\n    box-shadow: ",";\n    z-index: 2;\n    ",";\n\n    &::placeholder {\n      /* Chrome, Firefox, Opera, Safari 10.1+ */\n      color: ",";\n      opacity: 1; /* Firefox */\n    }\n\n    &:-ms-input-placeholder {\n      /* Internet Explorer 10-11 */\n      color: ",";\n    }\n\n    &::-ms-input-placeholder {\n      /* Microsoft Edge */\n      color: ",";\n    }\n  }\n\n  & .filter {\n    position: relative;\n    width: 100%;\n    box-sizing: border-box;\n\n    & > ul {\n      box-sizing: border-box;\n      position: absolute;\n      top: -20px;\n      left: 0;\n      width: 100%;\n      list-style: none;\n      margin: 0;\n      padding: 0;\n      max-height: 200px;\n      border: ",";\n      border-top: none;\n      border-radius: ",";\n      box-shadow: ",";\n      overflow: auto;\n      z-index: 1;\n      ",";\n\n      & > li {\n        box-sizing: border-box;\n        cursor: pointer;\n        padding: ",";\n        background-color: ",";\n        color: ",";\n        width: 100%;\n        ","\n\n        &:first-child {\n          padding-top: ","px;\n        }\n\n        &:last-child {\n          border-radius: ",";\n        }\n\n        &.current {\n          background-color: ",";\n          color: ",";\n          font-weight: ",";\n          font-size: ",";\n          ","\n        }\n      }\n\n      & > .no-match {\n        box-sizing: border-box;\n        width: 100%;\n        color: ",";\n        ","\n      }\n    }\n  }\n"],n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}})));return y=function(){return t},t}var b=c.div.attrs((function(e){var n=s({},e.style);return{style:s({},{divMargin:n.divMargin||"10px 10px 0 10px",divWidth:n.divWidth||"300px",divFont:n.divFont||"'Arial', Sans-Serif",divOthers:n.divOthers||"",inputPadding:n.inputPadding||"8px",inputFontSize:n.inputFontSize||"1rem",inputColor:n.inputColor||"rgb(60,60,60)",inputBorderTop:n.inputBorderTop||"none",inputBorderLeft:n.inputBorderLeft||"none",inputBorderBot:n.inputBorderBot||"3px solid #66d0dd",inputBorderRight:n.inputBorderRight||"none",inputOutline:n.inputOutline||"#66d0dd auto 3px",inputBackground:n.inputBackground||"fff",inputShadow:n.inputShadow||"0 0 5px rgba(0,0,0,.3)",inputPlaceHolder:n.inputPlaceHolder||"auto",inputOthers:n.inputOthers||"",listBorder:n.listBorder||"2px solid #66d0dd",listBorderRound:n.listBorderRound?"0 0 8px 8px":"0 0 0 0",listOthers:n.listOthers||"",itemPadding:n.itemPadding||"10px",itemBackground:n.itemBackground||"#fff",itemColor:n.itemColor||"rgb(60,60,60)",itemOthers:n.itemOthers||"",currentBackground:n.currentBackground||"#66d0dd",currentColor:n.currentColor||"#fff",currentFontWeight:n.currentFontWeight||"bold",currentFontSize:n.currentFontSize||"1.1rem",currentOthers:n.currentOthers||"",noMatchColor:n.noMatchColor||"rgb(180,180,180)",noMatchOthers:n.noMatchOthers||""})}}))(y(),(function(e){return e.style.divMargin}),(function(e){return e.style.divWidth}),(function(e){return e.style.divFont}),(function(e){return e.style.inputPadding}),(function(e){return e.style.inputFontSize}),(function(e){return e.style.inputColor}),(function(e){return e.style.inputBorderTop}),(function(e){return e.style.inputBorderLeft}),(function(e){return e.style.inputBorderBot}),(function(e){return e.style.inputBorderRight}),(function(e){return e.style.inputOutline}),(function(e){return e.style.inputBackground}),(function(e){return e.style.inputShadow}),(function(e){return e.style.inputOthers}),(function(e){return e.style.inputPlaceHolder}),(function(e){return e.style.inputPlaceHolder}),(function(e){return e.style.inputPlaceHolder}),(function(e){return e.style.listBorder}),(function(e){return e.style.listBorderRound}),(function(e){return e.style.inputShadow}),(function(e){return e.style.listOthers}),(function(e){return e.style.itemPadding}),(function(e){return e.style.itemBackground}),(function(e){return e.style.itemColor}),(function(e){return e.style.itemOthers}),(function(e){return parseInt(e.style.itemPadding.replace("px",""))+20}),(function(e){return e.style.listBorderRound}),(function(e){return e.style.currentBackground}),(function(e){return e.style.currentColor}),(function(e){return e.style.currentFontWeight}),(function(e){return e.style.currentFontSize}),(function(e){return e.style.currentOthers}),(function(e){return e.style.noMatchColor}),(function(e){return e.style.noMatchOthers})),h=e.forwardRef((function(o,i){var u=o.data,l=o.filter,c=o.ListComponent,a=o.onSelect,d=o.onChange,p=o.showAtOnce,m=o.placeholder,y=o.noMatchMessage,h=o.style,g=o.setOptions,v=o.disableFunc,w=f(n(u),2),x=w[0],O=w[1],k=f(n(0),2),C=k[0],E=k[1],B=f(n(""),2),R=B[0],j=B[1],P=f(n([]),2),S=P[0],z=P[1],F=f(n(!1),2),M=F[0],N=F[1],q=t(null);r((function(){if(v){var e=u.map((function(e){return s({},e,{disable:v(e)})}));O(e)}else O(u)}),[u,v]),r((function(){g&&g({clean:function(){j(""),E(0),N(!1)}})}),[g]),r((function(){if(!M){if(1===R.length&&" "===R.charAt(0))return void j("");var e=[];if(""===R&&p||""!==R){for(var n,t=/\W/gi,r="^".concat(R.toLowerCase().trim()),o=[];null!==(n=t.exec(R));)o.includes(n[0])||(r=r.replace(RegExp("\\".concat(n[0]),"gi"),"\\".concat(n[0])),o.push(n[0]));e=x.filter((function(e){return new RegExp(r).test(e[l].toLowerCase().trim())}))}z(e),q.current&&q.current.scroll(0,0)}}),[R,x,p,l,M]);var T=function(e){E(e)},A=function(e){D(C)},D=function(e){S[e]&&(S[e].disable||(a(S[e]),j(S[e][l]),z([]),E(0),N(!0)))};return e.createElement(b,{style:h},e.createElement("input",{type:"text",spellCheck:"false",placeholder:m,onKeyDown:function(e){38===e.keyCode?(e.preventDefault(),C>0&&(E((function(e){return e-1})),document.querySelector(".filter > ul > .current").scrollIntoView({block:"end",behavior:"smooth"}))):40===e.keyCode&&C<S.length-1&&(""!==R||p)&&!M?(e.preventDefault(),E((function(e){return e+1})),document.querySelector(".filter > ul > .current").scrollIntoView({block:"start",behavior:"smooth"})):32===e.keyCode?(0===R.length||R.endsWith(" "))&&e.preventDefault():13===e.keyCode&&D(C)},onChange:function(e){j(e.target.value),E(0),N(!1),d&&d()},value:R,ref:i}),(R.length>0||p)&&!M&&e.createElement("div",{className:"filter"},e.createElement("ul",{ref:q},!M&&S.map((function(n,t){return e.createElement(c,{key:t,index:t,current:C===t,data:n,onMouseEnter:T,onClick:A})})),0===S.length&&R.length>0&&!M&&e.createElement("li",{className:"no-match"},y))))}));h.displayName="SelectFilter",h.defaultProps={showAtOnce:!1,placeholder:"",noMatchMessage:"No se han encontrado resultados"},h.propTypes={data:o.arrayOf(o.object).isRequired,filter:o.string.isRequired,ListComponent:o.any.isRequired,onSelect:o.func.isRequired,onChange:o.func,showAtOnce:o.bool,placeholder:o.string,noMatchMessage:o.string,style:o.object,setOptions:o.func,disableFunc:o.func};var g=e.forwardRef((function(r,o){var i=r.maxNumber,u=void 0===i?100:i,l=r.minNumber,c=void 0===l?1:l,a=r.handleAccept,d=r.labelText,s=void 0===d?"Cantidad":d,p=r.buttonText,m=void 0===p?"Añadir":p,y=f(n(!1),2),b=y[0],h=y[1],g=f(n(""),2),v=g[0],w=g[1],x=t();return e.createElement("div",{className:"quantity-input"},e.createElement("label",{htmlFor:"quantity"},s,e.createElement("input",{type:"text",onKeyUp:function(e){13===e.keyCode&&b?x.current.focus():b||h(!0)},ref:o,onKeyDown:function(e){/\d/.test(e.key)?parseInt(e.target.value+e.key,10)<=u&&parseInt(e.target.value+e.key,10)>=c&&w(e.target.value+e.key):8===e.keyCode&&w((function(e){return e.substr(0,e.length-1)}))},value:v,onChange:function(){}})),e.createElement("button",{type:"button",onClick:function(){return a(parseInt(v))},ref:x,className:"quantity-input_button",disabled:""===v},m))}));g.displayName="QuantityInput",g.propTypes={minNumber:o.number,maxNumber:o.number,handleAccept:o.func.isRequired,labelText:o.string,buttonText:o.string};export{p as DataTable,g as QuantityInput,h as SelectFilter};
